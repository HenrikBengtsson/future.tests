<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test Suite for Future API Backends • future.tests</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Test Suite for Future API Backends">
<meta property="og:description" content="Backends implementing the Future API, as defined by the future package, should use the tests provided by this package to validate that they meet the minimal requirements of the Future API.  The tests can be performed easily from within R or from outside of R from the command line making it easy to include them package tests and in Continuous Integration (CI) pipelines.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">future.tests</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1-9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HenrikBengtsson/future.tests/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><a href="https://cran.r-project.org/web/checks/check_results_future.tests.html" class="external-link"><img border="0" src="http://www.r-pkg.org/badges/version/future.tests" alt="CRAN version"></a> <a href="https://github.com/HenrikBengtsson/future.tests/actions?query=workflow%3AR-CMD-check" class="external-link"><img src="https://github.com/HenrikBengtsson/future.tests/workflows/R-CMD-check/badge.svg?branch=develop" alt="Build status"></a> <a href="https://travis-ci.org/HenrikBengtsson/future.tests" class="external-link"><img src="https://travis-ci.org/HenrikBengtsson/future.tests.svg" alt="Build status"></a> <a href="https://ci.appveyor.com/project/HenrikBengtsson/future-tests" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/HenrikBengtsson/future.tests?svg=true" alt="Build status"></a> <a href="https://codecov.io/gh/HenrikBengtsson/future.tests" class="external-link"><img src="https://codecov.io/gh/HenrikBengtsson/future.tests/branch/develop/graph/badge.svg" alt="Coverage Status"></a> <a href="https://www.r-consortium.org/projects/awarded-projects" class="external-link"><img border="0" src="reference/figures/lifecycle-maturing-blue.svg" alt="Life cycle: maturing"></a> <a href="https://www.r-consortium.org/projects/awarded-projects" class="external-link"><img border="0" src="reference/figures/R_Consortium-logo-horizontal-white-purple-badge.svg" alt="R Consortium ISC Project 2017-2"></a></p>
<div id="future-tests-test-suite-for-future-api-backends" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#future-tests-test-suite-for-future-api-backends" class="anchor"></a>future.tests: Test Suite for ‘Future API’ Backends</h1></div>
<p>The <strong><a href="https://cran.r-project.org/package=future" class="external-link">future</a></strong> package defines the Future API which consists of a small number of functions for writing <a href="https://www.r-project.org" class="external-link">R</a> code that can be evaluated either sequential or in parallel based a single setting without having to change anything in the code. Parallelization can be done via one of many backends, e.g. via built-in multicore, multisession and cluster backends (based on the <strong>parallel</strong> package) or via third-party backends such as <strong><a href="https://cran.r-project.org/package=future.callr" class="external-link">future.callr</a></strong> and <strong><a href="https://cran.r-project.org/package=future.batchtools" class="external-link">future.batchtools</a></strong>. The design motto of the Future API is:</p>
<blockquote>
<p>Write once, run anywhere</p>
</blockquote>
<p>In order for such code to work regardless of which future backend the end-user choose, it is critical that the backend fully complies with the Future API. A future backend with A 100% compliance rate guarantees that the code will work equally well there as in sequential mode.</p>
<p>This R package - <strong><a href="https://cran.r-project.org/package=future.tests" class="external-link">future.tests</a></strong> - provides a test suite for validation that a future backend complies with the Future API.</p>
<p><img src="reference/figures/screencast.gif"></p>
<div id="validate-a-future-backend" class="section level2">
<h2 class="hasAnchor">
<a href="#validate-a-future-backend" class="anchor"></a>Validate a Future Backend</h2>
<p>All future backends implementing the Future API should validate that they conform to the Future API. This can be done using the <strong><a href="https://cran.r-project.org/package=future.tests" class="external-link">future.tests</a></strong> package, which provides two API for running the tests. The tests can be performed either from within R or from outside of R from the command line making it easy to include them package tests and in Continuous Integration (CI) pipelines.</p>
</div>
<div id="from-within-r" class="section level2">
<h2 class="hasAnchor">
<a href="#from-within-r" class="anchor"></a>From Within R</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>results &lt;-<span class="st"> </span>future.tests<span class="op">::</span><span class="kw">check</span>(<span class="dt">plan =</span> <span class="st">"multisession"</span>)
<span class="op">&gt;</span><span class="st"> </span>exit_code &lt;-<span class="st"> </span><span class="kw">attr</span>(results, <span class="st">"exit_code"</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="cf">if</span> (exit_code <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">"One or more tests failed"</span>)</code></pre></div>
</div>
<div id="from-outside-r" class="section level2">
<h2 class="hasAnchor">
<a href="#from-outside-r" class="anchor"></a>From Outside R</h2>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">$ <span class="ex">Rscript</span> -e <span class="st">"future.tests::check"</span> --args --test-plan=<span class="st">"multisession"</span>
$ <span class="va">exit_code=$?</span>
$<span class="kw"> [[</span> exit_code <span class="ot">-eq</span> 0<span class="kw"> ]]</span> <span class="kw">||</span> <span class="kw">{</span> <span class="op">&gt;&amp;2</span> <span class="bu">echo</span> <span class="st">"One or more tests failed"</span><span class="kw">;</span> <span class="bu">exit</span> 1<span class="kw">;</span> <span class="kw">}</span></code></pre></div>
<div id="continuous-integration" class="section level3">
<h3 class="hasAnchor">
<a href="#continuous-integration" class="anchor"></a>Continuous Integration</h3>
<div id="travis-ci" class="section level4">
<h4 class="hasAnchor">
<a href="#travis-ci" class="anchor"></a>Travis CI</h4>
<p>To validate a future backend using future.tests on Travis CI, use a job matrix and add a separate job that runs <code>Rscript future.tests::check ...</code>. Here is an excerpt of a <code>.travis.yml</code> with a job matrix where one of the job performs a regular <code>R CMD check --as-cran</code> and one validates a specific backend using <strong>future.tests</strong>.</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">language:</span><span class="at"> r</span>
<span class="fu">sudo:</span><span class="at"> false</span>
<span class="fu">cache:</span><span class="at"> packages</span>
<span class="fu">warnings_are_errors:</span><span class="at"> false</span>
<span class="fu">r_check_args:</span><span class="at"> --as-cran</span>

<span class="fu">matrix:</span>
  <span class="fu">include:</span>
    <span class="kw">-</span> <span class="fu">os:</span><span class="at"> linux</span>
      <span class="fu">r:</span><span class="at"> release</span>
    <span class="kw">-</span> <span class="fu">os:</span><span class="at"> linux</span>
      <span class="fu">r:</span><span class="at"> release</span>
      <span class="fu">r_packages:</span>
        <span class="kw">-</span> future.tests
      <span class="fu">script:</span>
        <span class="kw">-</span> R CMD build --no-build-vignettes --no-manual .
        <span class="kw">-</span> R CMD INSTALL *.tar.gz
        <span class="kw">-</span> <span class="fu">Rscript -e future.tests:</span><span class="at">:check --args --test-plan="${BACKEND}"</span>
      <span class="fu">env:</span><span class="at"> BACKEND='future.callr::callr'</span></code></pre></div>
<p>See <a href="https://github.com/HenrikBengtsson/future.callr/blob/develop/.travis.yml" class="external-link">.travis.yml of the future.callr package</a> for a full example.</p>
</div>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>R package future.tests is available on <a href="https://cran.r-project.org/package=future.tests" class="external-link">CRAN</a> and can be installed in R as:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"future.tests"</span><span class="op">)</span></code></pre></div>
<div id="pre-release-version" class="section level3">
<h3 class="hasAnchor">
<a href="#pre-release-version" class="anchor"></a>Pre-release version</h3>
<p>To install the pre-release version that is available in Git branch <code>develop</code> on GitHub, use:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"HenrikBengtsson/future.tests"</span>, ref<span class="op">=</span><span class="st">"develop"</span><span class="op">)</span></code></pre></div>
<p>This will install the package from source.</p>
<div id="badges">
<!-- pkgdown markup -->

## Contributing

To contribute to this package, please see [CONTRIBUTING.md](CONTRIBUTING.md).

</div>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=future.tests">https://​cloud.r-project.org/​package=future.tests</a>
</li>
<li>Browse source code at <br><a href="https://github.com/HenrikBengtsson/future.tests/">https://​github.com/​HenrikBengtsson/​future.tests/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/HenrikBengtsson/future.tests/issues">https://​github.com/​HenrikBengtsson/​future.tests/​issues</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>LGPL (&gt;= 2.1)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing future.tests</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Henrik Bengtsson <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000 and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
